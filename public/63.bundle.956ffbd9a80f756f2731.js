"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[63],{74063:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var o=n(32735),r=n(60216),a=n.n(r),i=n(29684),l=n.n(i),c=n(82656),s=n.n(c),u=n(39016),f=n(98526),m=n(52938),d=n(8784),p=s().globalImageIdSpecificToolStateManager;function v(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var g={touch:[s().PanMultiTouchTool,s().ZoomTouchPinchTool],annotations:[s().ArrowAnnotateTool,s().BidirectionalTool,s().LengthTool,s().AngleTool,s().FreehandRoiTool,s().EllipticalRoiTool,s().DragProbeTool,s().RectangleRoiTool],other:[s().PanTool,s().ZoomTool,s().WwwcTool,s().WwwcRegionTool,s().MagnifyTool,s().StackScrollTool,s().StackScrollMouseWheelTool,s().OverlayTool]};function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,r,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var S=f.ZP.formatDate,E=s().ArrowAnnotateTool,w=s().BidirectionalTool,A=s().EllipticalRoiTool,I=s().LengthTool,P=s().importInternal("base/BaseAnnotationTool");u.ZP.utils.StackManager;function M(e){e.children,e.dataSource;var t=e.displaySet,n=e.viewportIndex,r=e.servicesManager,a=e.extensionManager,i=e.commandsManager,c=r.services.ToolBarService,f=T((0,d.I)(),1)[0],h=T((0,m.O_)(),2),b=h[0],M=b.activeViewportIndex,C=b.viewports,D=(h[1],T((0,m.vQ)(),2)),x=D[0],F=x.isCineEnabled,O=x.cines,j=D[1],R=T((0,m.en)(),2),B=R[0],N=(R[1],T((0,o.useState)(!1),2)),Z=N[0],U=N[1],W=T((0,o.useState)(null),2),L=W[0],V=W[1],_=T((0,o.useState)(null),2),q=_[0],$=_[1],G=function(e){var t=e.detail.element,o=function(){var e=[];return Object.keys(g).forEach((function(t){return e.push.apply(e,v(g[t]))})),e}(),r=c.state.primaryToolId;!function(e,t){var n=s().importInternal("base/BaseAnnotationTool");t.forEach((function(t){if(t.prototype instanceof n){var o=(new t).name;s().setToolPassiveForElement(e,o)}})),s().setToolActiveForElement(e,"Pan",{mouseButtonMask:4}),s().setToolActiveForElement(e,"Zoom",{mouseButtonMask:2}),s().setToolActiveForElement(e,"Wwwc",{mouseButtonMask:1}),s().setToolActiveForElement(e,"StackScrollMouseWheel",{}),s().setToolActiveForElement(e,"PanMultiTouch",{pointers:2}),s().setToolActiveForElement(e,"ZoomTouchPinch",{}),s().setToolEnabledForElement(e,"Overlay",{})}(t,o),s().setToolActiveForElement(t,r,{mouseButtonMask:1}),s().store.state.tools.filter((function(e){return e.element===t})).forEach((function(e){if(e instanceof E||e instanceof w||e instanceof A||e instanceof I){var t=e.configuration;t.renderDashed=!Z,e.configuration=t}else if(e instanceof P){var n=e.configuration;n.renderDashed=!0,e.configuration=n}})),l().getEnabledElement(t).image&&l().updateImage(t),$(t);var a=new CustomEvent("ohif-cornerstone-enabled-element-event",{detail:{context:"ACTIVE_VIEWPORT::TRACKED",enabledElement:t,viewportIndex:n}});document.dispatchEvent(a)};(0,o.useEffect)((function(){q&&(s().store.state.tools.filter((function(e){return e.element===q})).forEach((function(e){if(e instanceof E||e instanceof w||e instanceof A||e instanceof I){var t=e.configuration;t.renderDashed=!Z,e.configuration=t}})),l().getEnabledElement(q).image&&l().updateImage(q))}),[Z]);C.findIndex((function(e){return e.displaySetInstanceUID===t.displaySetInstanceUID}));var H=f.context.trackedSeries,K=t.Modality,Q=t.SeriesDate,Y=t.SeriesDescription,z=t.SeriesInstanceUID,J=t.SeriesNumber,X=t.images[0],ee=X.PatientID,te=X.PatientName,ne=X.PatientSex,oe=X.PatientAge,re=X.SliceThickness,ae=X.SpacingBetweenSlices,ie=X.ManufacturerModelName;H.includes(z)!==Z&&U(!Z);var le=C.length>1?k[n]:"";function ce(e){if(q){var t=function(e,t,n,o){var r=t.services.MeasurementService.getMeasurements(),a=o.context.trackedSeries,i=r.filter((function(e){return a.includes(e.referenceSeriesUID)}));if(!i.length)return;var l=i.length,c=i.map((function(e){return e.id})),s=c.findIndex((function(e){return e===n}));-1===s?s=0:"left"===e?--s<0&&(s=l-1):"right"===e&&++s===l&&(s=0);return c[s]}(e,r,L,f);if(t){V(t);var o=r.services.MeasurementService;!function(e){var t=e.id,n=p.saveToolState();Object.keys(n).forEach((function(e){var o=n[e];Object.keys(o).forEach((function(e){var n=o[e].data;n&&n.length&&n.forEach((function(e){e.active=e.id===t}))}))})),s().store.state.enabledElements.forEach((function(e){try{l().updateImage(e)}catch(e){}}))}(o.getMeasurements().find((function(e){return e.id===t}))),o.jumpToMeasurement(n,t)}}}var se,ue=O[n],fe=ue&&ue.isPlaying||!1;ue&&ue.frameRate;return o.createElement(o.Fragment,null,o.createElement(m.uY,{onDoubleClick:function(e){e.stopPropagation(),e.preventDefault()},onSeriesChange:function(e){return ce(e)},studyData:{label:le,isTracked:Z,isLocked:!1,isRehydratable:!1,studyDate:S(Q),currentSeries:J,seriesDescription:Y,modality:K,patientInformation:{patientName:te?u.ZP.utils.formatPN(te.Alphabetic):"",patientSex:ne||"",patientAge:oe||"",MRN:ee||"",thickness:re?"".concat(parseFloat(re).toFixed(2),"mm"):"",spacing:void 0!==ae?"".concat(parseFloat(ae).toFixed(2),"mm"):"",scanner:ie||""}},showNavArrows:!F,showCine:F,cineProps:{isPlaying:fe,onClose:function(){return i.runCommand("toggleCine")},onPlayPauseChange:function(e){return j.setCine({id:M,isPlaying:e})},onFrameRateChange:function(e){return j.setCine({id:M,frameRate:e})}}}),o.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(se=a.getModuleEntry("org.ohif.cornerstone.viewportModule.cornerstone").component,o.createElement(se,y({onElementEnabled:G,element:q},e))),o.createElement("div",{className:"absolute w-full"},B.viewportIndex===n&&o.createElement(m.P_,{id:B.id,message:B.message,type:B.type,actions:B.actions,onSubmit:B.onSubmit,onOutsideClick:B.onOutsideClick}))))}M.propTypes={displaySet:a().object.isRequired,viewportIndex:a().number.isRequired,dataSource:a().object,children:a().node,customProps:a().object},M.defaultProps={customProps:{}};var k=["A","B","C","D","E","F","G","H","I"];var C=M}}]);
//# sourceMappingURL=63.bundle.956ffbd9a80f756f2731.js.map